<div class="courses-panel" style="margin-top: 170px;">
  <mat-card>
    <!-- ARIA landmark: header region for snapshot (T009) -->
    <header role="banner" aria-label="Match snapshot header">
      <mat-card-header class="mat-card-header-danger">
        <mat-card-title>LIVE</mat-card-title>
      </mat-card-header>
      
      <!-- 002-match-details-ux: Snapshot Header Component (T016-T020) -->
      <!-- NOTE: Using existing cricket-odds data until WebSocket/API integration complete -->
      <!-- <app-snapshot-header 
        *ngIf="matchId"
        [matchId]="matchId">
      </app-snapshot-header> -->
    </header>

    <!-- Main content area (T009) -->
    <main role="main" aria-label="Match details content">
      <mat-card-content>
        <app-live-hero
          class="cricket-odds__hero"
          *ngIf="matchId"
          [matchId]="matchId"
          [matchInfo]="matchInfo">
        </app-live-hero>

      <mat-tab-group (selectedTabChange)="onTabChange($event)">
        <!-- First Tab: Live Match -->
        <mat-tab label="Live Match">
          <!-- Existing Live Match Content -->
          <!-- Place your existing template content here -->
          <!-- ... -->
          <div *ngIf="isBetProcessing" class="loader-container">
            <div class="loader"></div>
            <!-- Optional: Add text like 'Confirming bet...' -->
          </div>
          <div class="live-match-container">

            <!-- Left Ad Container -->
            <div class="ad-container left-ad">
              <!-- Google AdSense Script (Load Once in index.html) -->
              <!-- AdSense ads should be initialized once, preferably in index.html -->
              <!-- If not already loaded, you can include it here, but it's recommended to load it once globally -->
              
              <!-- AdSense Ad Unit -->
              <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8903030190783903"
                crossorigin="anonymous"></script>
              <!-- right_add_vertical -->
              <ins class="adsbygoogle"
                  style="display:block"
                  data-ad-client="ca-pub-8903030190783903"
                  data-ad-slot="9439699334"
                  data-ad-format="auto"
                  data-full-width-responsive="true"></ins>
              <script>
                  (adsbygoogle = window.adsbygoogle || []).push({});
              </script>
            </div>

            <div class="cricket-odds-container" *ngIf="(last6Balls && last6Balls.length > 0) || userBets.length > 0 || (sessionExposures && sessionExposures.length > 0) || (!(testMatchOdds && testMatchOdds.length > 0) && favTeam !== '-' && !favTeam.includes('Unknown')) || (testMatchOdds && testMatchOdds.length > 0) || batsmanDataList.length > 0 || bowlerDataList.length > 0 || sessionOddsListDisplay.length > 0">
              <div class="cricket-odds">

                <!-- Last 6 Balls -->
                <div class="last-6-balls-container" *ngIf="last6Balls && last6Balls.length > 0">
                  <div class="balls-header">
                    <mat-icon class="balls-icon">sports_cricket</mat-icon>
                    <h3>Last 6 Balls</h3>
                  </div>
                  <div class="last-6-balls">
                    <div class="ball" *ngFor="let ball of last6Balls">
                      <div class="ball-score">{{ ball.score }}</div>
                    </div>
                  </div>
                </div>

                <!-- Overall Win/Loss Summary -->
                <div class="overall-win-loss" *ngIf="userBets.length > 0">
                  <div class="overall-item">
                    <span class="win-label">{{ winFormattedKey }}:</span>
                    <span [ngClass]="{'win-amount': totalPotentialWin >= 0, 'loss-amount': totalPotentialWin < 0}">{{
                      totalPotentialWin | currency }}</span>
                  </div>
                  <div class="overall-item">
                    <span class="loss-label">{{ loseFormattedKey }}:</span>
                    <span [ngClass]="{'win-amount': totalPotentialLoss >= 0, 'loss-amount': totalPotentialLoss < 0}">{{
                      totalPotentialLoss | currency }}</span>
                  </div>
                </div>
                <!-- Session Exposure Summary -->
                <div class="session-exposures" *ngIf="sessionExposures && sessionExposures.length > 0">
                  <div class="overall-item" *ngFor="let sessionExposure of sessionExposures">
                    <span class="win-label">{{ sessionExposure.name }}:</span>
                    <span [ngClass]="{'loss-amount': sessionExposure.amount >= 0, 'loss-amount': sessionExposure.amount < 0}">
                      {{ sessionExposure.amount | currency }}
                    </span>
                  </div>
                </div>
                
                <!-- Odds and Stats Section -->
                <div class="odds-stats-section" *ngIf="(!(testMatchOdds && testMatchOdds.length > 0) && favTeam !== '-' && !favTeam.includes('Unknown')) || (testMatchOdds && testMatchOdds.length > 0) || batsmanDataList.length > 0 || bowlerDataList.length > 0">
                
                <!-- Odds Toggle Button (Phase 7 Mobile Optimized) -->
                <div class="odds-toggle-container" style="margin: 16px 0; text-align: right;">
                  <button mat-button 
                          class="odds-toggle-btn"
                          (click)="showOdds = !showOdds"
                          style="background: #667eea; color: white; border-radius: 4px; padding: 8px 16px;">
                    <mat-icon style="vertical-align: middle; margin-right: 4px;">
                      {{ showOdds ? 'visibility_off' : 'visibility' }}
                    </mat-icon>
                    <span class="odds-toggle-label">{{ showOdds ? 'Hide Odds' : 'Show Odds' }}</span>
                  </button>
                </div>

                <!-- Favorite Team Odds -->
                <div *ngIf="showOdds && !(testMatchOdds && testMatchOdds.length > 0) && favTeam !== '-'">
                  <div *ngIf="!favTeam.includes('Unknown')" class="favorite-odds team-section">
                    <div class="team-label" [attr.data-full-name]="favTeam">{{getTruncatedTeamName(favTeam) }}</div>
                    <div class="odds-buttons">
                      <button mat-raised-button color="primary" [ngClass]="{'non-clickable': !isClickable}">
                        {{ backOdds }}</button>
                      <button mat-raised-button color="accent" [ngClass]="{'non-clickable': !isClickable}">{{ layOdds }}</button>
                    </div>
                  </div>

                  <div class="betting-options" [class.lay-active]="layButtonActive"
                    *ngIf="showBetting && (showBettingFor === 'teamSectionBackOdds' || showBettingFor === 'layOdds' )">
                    <div class="button-row">
                      <button mat-button class="cancel-bet" (click)="cancelBet()">Cancel</button>
                      <button mat-button class="clear-bet" (click)="clearStake()">Clear</button>
                    </div>

                    <div class="odds-amount">
                      <div class="odds">
                        <label for="odds">Odds:</label>
                        <input type="number" id="odds" class="disabled-input" readonly (input)="handleOddsInputChange()" (blur)="handleOddsBlur()" [value]="selectedOdds" />
                        <input type="hidden" name="odds" [value]="selectedOdds" />
                      </div>
                      <div class="amount">
                        <label for="amount">Amount:</label>
                        <input type="number" id="amount" [(ngModel)]="betAmount" />
                      </div>
                    </div>
                    <div class="quick-stakes">
                      <button *ngFor="let amount of quickStakeAmounts" (click)="setStake(amount)">
                        + {{ amount }}
                      </button>
                    </div>
                    <button mat-raised-button class="place-bet" color="primary" (click)="placeBet()">Place Bet</button>
                  </div>
                </div>

                <!-- Test Match Odds -->
                <div *ngIf="showOdds && testMatchOdds && testMatchOdds.length">
                  <div *ngFor="let match of testMatchOdds; let i = index" class="test-match-odds">
                    <div class="favorite-odds team-section">
                      <div class="team-label">{{ match.teamName }}</div>
                      <div class="odds-buttons">
                        <button mat-raised-button color="primary" [ngClass]="{'non-clickable': !isClickable}">
                          {{ match.odds.backOdds }}
                        </button>
                        <button mat-raised-button color="accent" [ngClass]="{'non-clickable': !isClickable}">
                          {{ match.odds.layOdds }}
                        </button>
                      </div>
                    </div>
                    <div class="betting-options"
                      *ngIf="showBetting && showBettingFor === 'testMatchOdds' && currentMatchIndex === i"
                      [class.lay-active]="layButtonActive">
                      <div class="button-row">
                        <button mat-button class="cancel-bet" (click)="cancelBet()">Cancel</button>
                        <button mat-button class="clear-bet" (click)="clearStake()">Clear</button>
                      </div>

                      <div class="odds">
                        <label for="odds{{i}}">Odds:</label>
                        <input type="number" id="odds{{i}}" class="disabled-input" [(ngModel)]="selectedOdds" readonly/>
                        <input type="hidden" name="odds{{i}}" [value]="selectedOdds" />
                      </div>
                      <div class="amount">
                        <label for="amount{{i}}">Amount:</label>
                        <input type="number" id="amount{{i}}" [(ngModel)]="betAmount" />
                      </div>
                      <button mat-raised-button class="place-bet" color="primary" (click)="placeTestBet(match)">Place Bet</button>
                    </div>
                  </div>
                </div>

                <div class="stats-container">
                  <!-- Batsman Stats -->
                  <div class="batsman-stats" *ngIf="batsmanDataList.length > 0">
                    <div class="stats-header">
                      <mat-icon class="stats-icon">sports_cricket</mat-icon>
                      <h3>Current Batsmen</h3>
                    </div>
                    <table class="stats-table">
                      <thead>
                        <tr>
                          <th>Batsman</th>
                          <th>R</th>
                          <th>B</th>
                          <th>4s</th>
                          <th>6s</th>
                          <th>SR</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let batsman of batsmanDataList">
                          <td class="player-name">
                            {{ batsman.name }}
                            <mat-icon *ngIf="batsman.onStrike" class="on-strike-icon">sports_cricket</mat-icon>
                          </td>
                          <td class="stat-value">{{ batsman.score }}</td>
                          <td class="stat-value">{{ batsman.ballsFaced }}</td>
                          <td class="stat-value">{{ batsman.fours }}</td>
                          <td class="stat-value">{{ batsman.sixes }}</td>
                          <td class="stat-value highlight-sr">{{ batsman.strikeRate }}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <!-- Bowler Stats -->
                  <div class="bowler-stats" *ngIf="bowlerDataList.length > 0">
                    <div class="stats-header">
                      <mat-icon class="stats-icon">sports_baseball</mat-icon>
                      <h3>Current Bowler</h3>
                    </div>
                    <table class="stats-table">
                      <thead>
                        <tr>
                          <th>Bowler</th>
                          <th>O</th>
                          <th>R</th>
                          <th>W</th>
                          <th>D</th>
                          <th>ECO</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let bowler of bowlerDataList">
                          <td class="player-name">{{ bowler.name }}</td>
                          <td class="stat-value">{{ bowler.ballsBowled }}</td>
                          <td class="stat-value">{{ bowler.score }}</td>
                          <td class="stat-value highlight-wickets">{{ bowler.wicketsTaken }}</td>
                          <td class="stat-value">{{ bowler.dotBalls }}</td>
                          <td class="stat-value highlight-eco">{{ bowler.economyRate }}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                
                </div>
                <!-- End Odds and Stats Section -->

                <section class="hero-downstream">
                <!-- Session Odds -->
                <ng-container *ngIf="showOdds">
                <div *ngFor="let sessionOdds of sessionOddsListDisplay">
                  <div *ngIf="sessionOdds.session !== '-'">
                    <div class="favorite-odds session-section">
                      <div class="session-label">{{ sessionOdds.session }}</div>
                      <div class="odds-buttons">
                        <button mat-raised-button color="primary" [ngClass]="{'non-clickable': !isClickable}"
                                (click)="showBetForOdds('sessionBackOdds')">NO {{ sessionOdds.backOdds }}</button>
                        <button mat-raised-button color="accent" [ngClass]="{'non-clickable': !isClickable}"
                                (click)="showBetForOdds('sessionLayOdds')">YES {{ sessionOdds.layOdds }}</button>
                      </div>
                    </div>
                
                    <div class="betting-options" [class.lay-active]="layButtonActive"
                         *ngIf="showBetting && (showBettingFor === 'sessionBackOdds' || showBettingFor === 'sessionLayOdds')">
                      <div class="button-row">
                        <button mat-button class="cancel-bet" (click)="cancelBet()">Cancel</button>
                        <button mat-button class="clear-bet" (click)="clearStake()">Clear</button>
                      </div>
                
                      <div class="odds-amount">
                        <div class="amount">
                          <label for="amount">Amount:</label>
                          <input type="number" id="amount" [(ngModel)]="betAmount" />
                        </div>
                      </div>
                
                      <div class="quick-stakes">
                        <button *ngFor="let amount of quickStakeAmounts" (click)="setStake(amount)">
                          + {{ amount }}
                        </button>
                      </div>
                      
                      <button mat-raised-button class="place-bet" color="primary" (click)="placeSessionBet()">Place Bet</button>
                    </div>
                  </div>
                </div>
                </ng-container>
                </section>
                
              </div>
            </div>

            <!-- Left Ad Container -->
            <div class="ad-container right-ad">
              <!-- Google AdSense Script (Load Once in index.html) -->
              <!-- AdSense ads should be initialized once, preferably in index.html -->
              <!-- If not already loaded, you can include it here, but it's recommended to load it once globally -->
              
              <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8903030190783903"
                  crossorigin="anonymous"></script>
              <!-- odds_page_both_side_vertical -->
              <ins class="adsbygoogle"
                  style="display:block"
                  data-ad-client="ca-pub-8903030190783903"
                  data-ad-slot="9428623879"
                  data-ad-format="auto"
                  data-full-width-responsive="true"></ins>
              <script>
                  (adsbygoogle = window.adsbygoogle || []).push({});
              </script>
            </div>


          </div>
        </mat-tab>

        <!-- Second Tab: Match Info -->
        <mat-tab label="Match Info">
          <!-- 002-match-details-ux: Enhanced Match Info Display -->
          <app-match-details-info 
            *ngIf="matchInfo"
            [matchInfo]="matchInfo">
          </app-match-details-info>
          
          <!-- Existing detailed match info (team comparison, venue stats, etc.) -->
          <div class="match-info-container" *ngIf="matchInfo">
            <!-- Match Overview Section -->
            <section class="match-overview">
              <div class="overview-header">
                <!-- <img src="assets/icons/series.png" alt="Series Logo" class="series-logo"> -->
                <div class="match-details">
                  <h2>{{ matchInfo.match_name }}</h2>
                  <p class="series-name">{{ matchInfo.series_name }}</p>
                </div>
              </div>
              <div class="overview-content">
                <div class="match-date-venue">
                  <div class="date">
                    <mat-icon>event</mat-icon>
                    <span>{{ matchInfo.match_date | date: 'fullDate' }}, {{ matchInfo.match_date | date: 'shortTime' }}</span>
                  </div>
                  <div class="venue">
                    <mat-icon>location_on</mat-icon>
                    <span>{{ matchInfo.venue }}</span>
                  </div>
                </div>
                <div class="toss-info">
                  <mat-icon>info</mat-icon>
                  <span>{{ matchInfo.toss_info }}</span>
                </div>
              </div>
            </section>
          
            <!-- Team Comparison Section -->
            <section class="team-comparison">
              <h2 class="section-title">Team Comparison</h2>
              
              <div class="team-comparison-table">
                <!-- Team Headers -->
                <div class="team-headers">
                  <!-- Left Team Header -->
                  <div class="team-header left-team">
                    <div class="team-logo-name">
                      <!-- <img [src]="getTeamLogo(teamComparisonKeys[0])" alt="{{ teamComparisonKeys[0] }} Logo" class="team-logo"> -->
                      <h3 class="team-name">{{ teamComparisonKeys[0] }}</h3>
                    </div>
                  </div>
                  
                  <!-- Stat Headings -->
                  <div class="stat-heading">
                    <h3>Stats</h3>
                  </div>
                  
                  <!-- Right Team Header -->
                  <div class="team-header right-team">
                    <div class="team-logo-name">
                      <!-- <img [src]="getTeamLogo(teamComparisonKeys[1])" alt="{{ teamComparisonKeys[1] }} Logo" class="team-logo"> -->
                      <h3 class="team-name">{{ teamComparisonKeys[1] }}</h3>
                    </div>
                  </div>
                </div>
                
                <!-- Stats Rows -->
                <div class="stats-rows">
                  <div class="stat-row" *ngFor="let key of teamComparisonSubKeys">
                    <!-- Left Team Stat Value -->
                    <div class="team-stat left-team">
                      {{ matchInfo.team_comparison[teamComparisonKeys[0]][key] }}
                    </div>
                    
                    <!-- Stat Heading -->
                    <div class="stat-key">
                      {{ key | titlecase }}
                    </div>
                    
                    <!-- Right Team Stat Value -->
                    <div class="team-stat right-team">
                      {{ matchInfo.team_comparison[teamComparisonKeys[1]][key] }}
                    </div>
                  </div>
                </div>
              </div>
            </section>
          
            <!-- Venue Stats Section -->
            <!-- cricket-odds.component.html -->
            <section class="venue-stats">
              <h2 class="section-title">Venue Statistics</h2>
              <div class="venue-stats-content">
                
                <!-- Venue Summary -->
                <div class="venue-summary">
                  
                  <!-- Matches Stat Card -->
                  <div class="stat-card">
                    <mat-icon class="stat-icon">sports_cricket</mat-icon>
                    <div class="stat-details">
                      <span class="stat-value">{{ matchInfo.venue_stats.matches }}</span>
                      <span class="stat-key">Matches</span>
                    </div>
                  </div>
                  
                  <!-- Progress Bars for Win Bat First and Win Bowl First -->
                  <div class="progress-bars">
                    
                    <!-- Win Bat First Progress Bar -->
                    <mat-card class="progress-card">
                      <div class="progress-header">
                        <span class="stat-key">Win Bat First</span>
                        <span class="percentage">{{ winBatFirstPercentage }}%</span>
                      </div>
                      <mat-progress-bar
                        mode="determinate"
                        [value]="winBatFirstPercentage"
                        color="primary">
                      </mat-progress-bar>
                    </mat-card>
                    
                    <!-- Win Bowl First Progress Bar -->
                    <mat-card class="progress-card">
                      <div class="progress-header">
                        <span class="stat-key">Win Bowl First</span>
                        <span class="percentage">{{ winBowlFirstPercentage }}%</span>
                      </div>
                      <mat-progress-bar
                        mode="determinate"
                        [value]="winBowlFirstPercentage"
                        color="warn">
                      </mat-progress-bar>
                    </mat-card>
                    
                  </div>
                  
                </div>
                

                <!-- Venue Averages -->
                <div class="venue-averages">
                  <div class="average-card">
                    <span class="average-title">Avg 1st Inns</span>
                    <strong class="average-value">{{ matchInfo.venue_stats.avg_1st_inns }}</strong>
                  </div>
                  <div class="average-card">
                    <span class="average-title">Avg 2nd Inns</span>
                    <strong class="average-value">{{ matchInfo.venue_stats.avg_2nd_inns }}</strong>
                  </div>
                  <!-- Add more average cards as needed -->
                </div>
                
              </div>
            </section>
          
            <!-- Playing XI Section -->
            <section class="playing-xi">
              <h3>Playing XI</h3>
              <mat-tab-group>
                <mat-tab *ngFor="let team of playingXIKeys" [label]="team">
                  <div class="playing-xi-content">
                    <div class="player-card" *ngFor="let player of matchInfo.playing_xi[team]">
                      <mat-icon class="player-icon">{{ getPlayerIcon(player.playerRole) }}</mat-icon>
                      <div class="player-details">
                        <h4>{{ player.playerName }}</h4>
                        <p>{{ player.playerRole }}</p>
                      </div>
                    </div>
                  </div>
                </mat-tab>
              </mat-tab-group>
            </section>
          
            <!-- Team Form Section -->
            <section class="team-form">
              <h3>Team Form (Last 5 Matches)</h3>
              <div class="team-form-cards">
                <div class="team-form-card" *ngFor="let team of teamFormKeys">
                  <div class="team-form-header">
                    <!-- <img [src]="getTeamLogo(team)" alt="{{ team }} Logo" class="team-logo"> -->
                    <h4>{{ team }}</h4>
                  </div>
                  <div class="match-results">
                    <div class="match-result" *ngFor="let match of matchInfo.team_form[team]">
                      <span class="result {{ getResultClass(match.result) }}">{{ match.result }}</span>
                      <p>{{ match.match_name }} - {{ match.series_name }}</p>
                    </div>
                  </div>
                </div>
              </div>
            </section>
          </div>
          
          <!-- Loading Indicator -->
          <div class="loading-indicator" *ngIf="!matchInfo">
            <mat-spinner></mat-spinner>
            <p>Loading match info...</p>
          </div>
        </mat-tab>

        <!-- Third Tab: Scorecard -->
        <mat-tab label="Scorecard">
          <!-- Use existing scorecard component (already working) -->
          <div *ngIf="scorecardData">
            <app-scorecard [scorecardInfo]="scorecardData"></app-scorecard>
          </div>
          
          <!-- Loading state -->
          <div *ngIf="!scorecardData">
            <p>Loading scorecard...</p>
          </div>
        </mat-tab>
        
        <!-- Fourth Tab: Lineups (NEW - T032-T035) -->
        <mat-tab label="Lineups">
          <app-lineups
            *ngIf="matchInfo && matchInfo.playing_xi"
            [playingXIData]="matchInfo">
          </app-lineups>
          
          <div *ngIf="!matchInfo || !matchInfo.playing_xi">
            <p>Loading lineups...</p>
          </div>
        </mat-tab>
      </mat-tab-group>

    </mat-card-content>
    </main> <!-- End main role -->
  </mat-card>
</div>