<div class="container"
     appPullToRefresh
     (refresh)="onRefreshHome()">
  
  <!-- ===== PAGE HEADER ===== -->
  <header class="home__header">
    <h1 class="home__title">Live Cricket Scores & Real-time Updates</h1>
    <p class="home__subtitle">Stay updated with live matches, upcoming fixtures, and recent results on Crickzen</p>
  </header>
  
  <!-- ===== LIVE MATCHES SECTION ===== -->
  <section 
    class="home__section home__section--live" 
    *ngIf="!isLoadingMatches && liveMatches.length > 0"
    role="region"
    aria-labelledby="live-matches-heading">
    <div class="home__section-header">
      <div class="home__section-title-wrapper">
        <span class="live-indicator" aria-hidden="true"></span>
        <h2 id="live-matches-heading" class="home__section-title">Live Now</h2>
      </div>
      <div class="home__section-actions">
        <!-- Desktop carousel controls - hidden on mobile -->
        <button 
          class="carousel-btn carousel-btn--left hidden-mobile" 
          (click)="scrollLeft('live-matches-grid')"
          [disabled]="!canScrollLeft('live-matches-grid')"
          appTouchFeedback
          aria-label="Scroll left through live matches">
          <i class="material-icons" aria-hidden="true">chevron_left</i>
        </button>
        <button 
          class="carousel-btn carousel-btn--right hidden-mobile" 
          (click)="scrollRight('live-matches-grid')"
          [disabled]="!canScrollRight('live-matches-grid')"
          appTouchFeedback
          aria-label="Scroll right through live matches">
          <i class="material-icons" aria-hidden="true">chevron_right</i>
        </button>
        <a routerLink="/matches" class="home__section-link" appTouchFeedback aria-label="View all live matches">
          View All
          <i class="material-icons" aria-hidden="true">arrow_forward</i>
        </a>
      </div>
    </div>
    <!-- Mobile: Vertical stacked layout -->
    <div class="matches-grid-wrapper matches-grid-wrapper--mobile">
      <div class="matches-grid matches-grid--mobile" id="live-matches-grid">
        <!-- Use mobile-optimized match card on mobile, existing card on desktop -->
        <app-mobile-match-card
          *ngFor="let match of liveMatches; trackBy: trackByMatchId"
          [match]="match"
          [showStatus]="true"
          [clickable]="true"
          class="visible-mobile"
          appTouchFeedback
          appLongPress
          (longPress)="onMatchLongPress($event, match.id)"
          (cardClick)="onMobileMatchClick($event)"
        ></app-mobile-match-card>
        <app-match-card
          *ngFor="let match of liveMatches; trackBy: trackByMatchId"
          [match]="match"
          [enableAnimations]="true"
          [showDetailsButton]="true"
          class="hidden-mobile"
          appTouchFeedback
          appLongPress
          (longPress)="onMatchLongPress($event, match.id)"
          (cardClick)="onMatchClick(match)"
          (detailsClick)="onDetailsClick(match)"
        ></app-match-card>
      </div>
    </div>
  </section>
  
  <!-- ===== UPCOMING MATCHES SECTION ===== -->
  <section 
    class="home__section home__section--upcoming" 
    *ngIf="!isLoadingMatches && upcomingMatches.length > 0"
    role="region"
    aria-labelledby="upcoming-matches-heading">
    <div class="home__section-header">
      <div class="home__section-title-wrapper">
        <i class="material-icons home__section-icon" aria-hidden="true">schedule</i>
        <h2 id="upcoming-matches-heading" class="home__section-title">Upcoming Matches</h2>
      </div>
      <div class="home__section-actions">
        <button 
          class="carousel-btn carousel-btn--left hidden-mobile" 
          (click)="scrollLeft('upcoming-matches-grid')"
          [disabled]="!canScrollLeft('upcoming-matches-grid')"
          aria-label="Scroll left through upcoming matches">
          <i class="material-icons" aria-hidden="true">chevron_left</i>
        </button>
        <button 
          class="carousel-btn carousel-btn--right hidden-mobile" 
          (click)="scrollRight('upcoming-matches-grid')"
          [disabled]="!canScrollRight('upcoming-matches-grid')"
          aria-label="Scroll right through upcoming matches">
          <i class="material-icons" aria-hidden="true">chevron_right</i>
        </button>
        <a routerLink="/matches" class="home__section-link" aria-label="View all upcoming matches">
          View All
          <i class="material-icons" aria-hidden="true">arrow_forward</i>
        </a>
      </div>
    </div>
    <div class="matches-grid-wrapper matches-grid-wrapper--mobile">
      <div class="matches-grid matches-grid--mobile" id="upcoming-matches-grid">
        <app-mobile-match-card
          *ngFor="let match of upcomingMatches; trackBy: trackByMatchId"
          [match]="match"
          [showStatus]="true"
          [clickable]="true"
          class="visible-mobile"
          appTouchFeedback
          (cardClick)="onMobileMatchClick($event)"
        ></app-mobile-match-card>
        <app-match-card
          *ngFor="let match of upcomingMatches; trackBy: trackByMatchId"
          [match]="match"
          [enableAnimations]="false"
          [showDetailsButton]="true"
          class="hidden-mobile"
          appTouchFeedback
          (cardClick)="onMatchClick(match)"
          (detailsClick)="onDetailsClick(match)"
        ></app-match-card>
      </div>
    </div>
  </section>
  
  <!-- ===== RECENT RESULTS SECTION ===== -->
  <section 
    class="home__section home__section--recent" 
    *ngIf="!isLoadingMatches && recentMatches.length > 0"
    role="region"
    aria-labelledby="recent-matches-heading">
    <div class="home__section-header">
      <div class="home__section-title-wrapper">
        <i class="material-icons home__section-icon" aria-hidden="true">check_circle</i>
        <h2 id="recent-matches-heading" class="home__section-title">Recent Results</h2>
      </div>
      <div class="home__section-actions">
        <button 
          class="carousel-btn carousel-btn--left hidden-mobile" 
          (click)="scrollLeft('recent-matches-grid')"
          [disabled]="!canScrollLeft('recent-matches-grid')"
          aria-label="Scroll left through recent matches">
          <i class="material-icons" aria-hidden="true">chevron_left</i>
        </button>
        <button 
          class="carousel-btn carousel-btn--right hidden-mobile" 
          (click)="scrollRight('recent-matches-grid')"
          [disabled]="!canScrollRight('recent-matches-grid')"
          aria-label="Scroll right through recent matches">
          <i class="material-icons" aria-hidden="true">chevron_right</i>
        </button>
        <a routerLink="/matches" class="home__section-link" aria-label="View all recent matches">
          View All
          <i class="material-icons" aria-hidden="true">arrow_forward</i>
        </a>
      </div>
    </div>
    <div class="matches-grid-wrapper matches-grid-wrapper--mobile">
      <div class="matches-grid matches-grid--mobile" id="recent-matches-grid">
        <app-mobile-match-card
          *ngFor="let match of recentMatches; trackBy: trackByMatchId"
          [match]="match"
          [showStatus]="true"
          [clickable]="true"
          class="visible-mobile"
          appTouchFeedback
          (cardClick)="onMobileMatchClick($event)"
        ></app-mobile-match-card>
        <app-match-card
          *ngFor="let match of recentMatches; trackBy: trackByMatchId"
          [match]="match"
          [enableAnimations]="false"
          [showDetailsButton]="true"
          class="hidden-mobile"
          appTouchFeedback
          (cardClick)="onMatchClick(match)"
          (detailsClick)="onDetailsClick(match)"
        ></app-match-card>
      </div>
    </div>
  </section>
  
  <!-- ===== LOADING STATE ===== -->
  <section 
    class="home__section" 
    *ngIf="isLoadingMatches"
    role="status"
    aria-live="polite"
    aria-label="Loading cricket matches">
    <div class="home__section-header">
      <h2 class="home__section-title">Loading Matches...</h2>
    </div>
    <div class="matches-grid matches-grid--mobile">
      <app-loading-skeleton 
        *ngFor="let i of [1, 2, 3]"
        type="card"
        [customClass]="'match-skeleton'"
      ></app-loading-skeleton>
    </div>
  </section>
  
  <!-- ===== ERROR STATE ===== -->
  <section class="matches-section" *ngIf="hasMatchError && !isLoadingMatches">
    <div class="error-message">
      <mat-card>
        <h3>Unable to Load Matches</h3>
        <p>There was an error loading cricket matches. Please try refreshing the page.</p>
        <button mat-raised-button color="primary" (click)="loadMatches()">Retry</button>
      </mat-card>
    </div>
  </section>
  
  <!-- ===== NO MATCHES STATE ===== -->
  <section class="matches-section" *ngIf="!isLoadingMatches && !hasMatchError && liveMatches.length === 0 && upcomingMatches.length === 0 && recentMatches.length === 0">
    <div class="no-matches-container">
      <mat-card class="no-matches-card">
        <h3>No Live Matches</h3>
        <p>There are currently no live cricket matches available. Please check back later.</p>
      </mat-card>
    </div>
  </section>
  
  <hr class="news-hr" />

  <!-- ===== BLOG POSTS SECTION (UNCHANGED) ===== -->
  <div *ngFor="let blogPost of blogPosts" class="news-item" (click)="openNews(blogPost.link)">
  <img [src]="blogPost.imgUrl" alt="{{ blogPost.title }}" class="news-image aspect-4-3" loading="lazy" />
    <div class="news-content">
      <h3 class="news-heading">{{ blogPost.title }}</h3>
      <p class="news-description">{{ blogPost.description | slice:0:400 }}...</p>

    </div>
  </div>
  
  <hr class="news-hr" *ngFor="let blogPost of blogPosts" />
</div>

<!-- T069-T071: Context Menu -->
<app-context-menu
  [visible]="showContextMenu"
  [position]="contextMenuPosition"
  [matchId]="selectedMatchId"
  [matchTitle]="selectedMatchTitle"
  [matchUrl]="selectedMatchUrl"
  (share)="onShareMatch($event)"
  (favorite)="onFavoriteMatch($event)"
  (openInNewTab)="onOpenInNewTab($event)"
  (close)="onCloseContextMenu()"
></app-context-menu>
